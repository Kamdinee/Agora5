{% extends "base.html.twig" %}

{% block central %}
<div class="col-sm-8">
  <section class="panel">
    <div class="chat-room-head">
      <h3><i class="fa fa-angle-right"></i> Gérer les jeux vidéo</h3>
    </div>
    <div class="panel-body">
      <table class="table table-striped table-advance table-hover">
        <thead>
          <tr class="tableau-entete">
            <th>Identifiant</th>
            <th>Nom</th>
            <th>Prix</th>
            <th>Genre</th>
            <th>Date de sortie</th>
            <th>Pegi</th>
            <th>Marque</th>
            <th>Plateforme</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <!-- Nouveau jeu -->
          <tr>
            <form action="{{ path('jeuxvideo_ajouter') }}" method="post">
              <td>Nouveau</td>
              <td><input type="text" name="txtNom" required></td>
              <td><input type="number" name="txtPrix" required min="0" step="0.01"></td>
              <td>
                {% set tbObjets, name, size, idSelect = tbGenres, 'lstGenre', 1, null %}
                {{ include('liste.html.twig') }}
              </td>
              <td><input type="date" name="txtDateParution" required></td>
              <td>
                {% set tbObjets, name, size, idSelect = tbPegis, 'lstPegi', 1, null %}
                {{ include('liste.html.twig') }}
              </td>
              <td>
                {% set tbObjets, name, size, idSelect = tbMarques, 'lstMarque', 1, null %}
                {{ include('liste.html.twig') }}
              </td>
              <td>
                {% set tbObjets, name, size, idSelect = tbPlateformes, 'lstPlateforme', 1, null %}
                {{ include('liste.html.twig') }}
              </td>
              <td>
                <button class="btn btn-primary btn-xs" type="submit" name="cmdAction" value="ajouterNouveauJeu" title="Enregistrer"><i class="fa fa-save"></i></button>
                <button class="btn btn-info btn-xs" type="reset" title="Effacer"><i class="fa fa-eraser"></i></button>
              </td>
            </form>
          </tr>

          {% for jeu in tbJeux %}
          <tr>
            <form method="post">
              <td>{{ jeu.identifiant }}<input type="hidden" name="txtIdJeux" value="{{ jeu.identifiant }}"></td>
              
              {% if jeu.identifiant != idJeuxModif %}
                <td>{{ jeu.nom }}</td>
                <td>{{ jeu.prix }}</td>
                <td>{{ jeu.libGenre }}</td>
                <td>{{ jeu.dateParution }}</td>
                <td>{{ jeu.descPegi }}</td>
                <td>{{ jeu.nomMarque }}</td>
                <td>{{ jeu.libPlateforme }}</td>
                <td>
                  {% if notification != 'rien' and jeu.identifiant == idJeuxNotif %}
                    <button class="btn btn-success btn-xs"><i class="fa fa-check"></i> {{ notification }}</button>
                  {% endif %}
                  <button class="btn btn-primary btn-xs" type="submit" name="cmdAction" value="demanderModifierJeux" title="Modifier" formaction="{{ path('jeuxvideo_demandermodifier') }}" formmethod="post"><i class="fa fa-pencil"></i></button>
                  <button class="btn btn-danger btn-xs" type="submit" name="cmdAction" value="supprimerJeu" title="Supprimer" formaction="{{ path('jeuxvideo_supprimer') }}" formmethod="post" onclick="return confirm('Voulez-vous vraiment supprimer ce jeu ?');"><i class="fa fa-trash-o"></i></button>
                </td>
              {% else %}
                <td><input type="text" name="txtNom" value="{{ jeu.nom }}" required></td>
                <td><input type="number" name="txtPrix" value="{{ jeu.prix }}" required min="0" step="0.01"></td>
                <td>
                  {% set tbObjets, name, size, idSelect = tbGenres, 'lstGenre', 1, jeu.idGenre %}
                  {{ include('liste.html.twig') }}
                </td>
                <td><input type="date" name="txtDateParution" value="{{ jeu.dateParution }}" required></td>
                <td>
                  {% set tbObjets, name, size, idSelect = tbPegis, 'lstPegi', 1, jeu.idPegi %}
                  {{ include('liste.html.twig') }}
                </td>
                <td>
                  {% set tbObjets, name, size, idSelect = tbMarques, 'lstMarque', 1, jeu.idMarque %}
                  {{ include('liste.html.twig') }}
                </td>
                <td>
                  {% set tbObjets, name, size, idSelect = tbPlateformes, 'lstPlateforme', 1, jeu.idPlateforme %}
                  {{ include('liste.html.twig') }}
                </td>
                <td>
                  <button class="btn btn-primary btn-xs" type="submit" name="cmdAction" value="validerModifierJeu" title="Enregistrer" formaction="{{ path('jeuxvideo_validermodifier') }}" formmethod="post"><i class="fa fa-save"></i></button>
                  <button class="btn btn-warning btn-xs" type="submit" name="cmdAction" value="annulerModifierJeu" title="Annuler" formaction="{{ path('jeuxvideo_afficher') }}" formmethod="get"><i class="fa fa-undo"></i></button>
                </td>
              {% endif %}
            </form>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
</div>
{% endblock %}
